(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6056:function(e,t,n){Promise.resolve().then(n.t.bind(n,2011,23)),Promise.resolve().then(n.bind(n,3552)),Promise.resolve().then(n.bind(n,1808))},1808:function(e,t,n){"use strict";n.r(t);var r=n(9268),o=n(6006),i=n(6169),a=n.n(i),s=n(1313),l=n(6936),u=n(4734),c=n(4313);let d=(0,s.ZF)({apiKey:"AIzaSyC8x4gmoJWbQJ3xHc1zydFCMlazRJWMBr0",authDomain:"gpttextbook-5d6c3.firebaseapp.com",projectId:"gpttextbook-5d6c3",storageBucket:"gpttextbook-5d6c3.appspot.com",messagingSenderId:"587182465589",appId:"1:587182465589:web:878023831c861384e9477c",measurementId:"G-370WMEKGLZ"}),f=(0,l.ad)(d),p=(0,u.v0)(),g=()=>{let[e,t]=(0,o.useState)("Answer appears here!"),[n,i]=(0,o.useState)("No answer yet..."),[s,d]=(0,o.useState)("gpt-3.5-turbo"),[g,m]=(0,o.useState)(!1),[h,b]=(0,o.useState)(null),[y,v]=(0,o.useState)(null),[w,_]=(0,o.useState)(0),[x,j]=(0,o.useState)(!1),S=async()=>{try{let e=(0,l.JU)(f,"users",String(y)),t=await (0,l.QT)(e);t.exists()?(console.log("Document data:",t.data()),_(t.data().tokens)):(console.log("No such document!"),_(0))}catch(e){console.error("Error getting document: ",e),_(0)}};(0,o.useEffect)(()=>{S();let e=setInterval(S,5e3);return()=>clearInterval(e)},[y]),(0,o.useEffect)(()=>{let e=(0,u.Aj)(p,e=>{e?(b(e),v(e.uid),console.log(e.uid),C(e.uid)):(b(null),v(null))});return()=>e()},[]);let k=async e=>{e.preventDefault();let t=new u.hJ;await (0,u.rh)(p,t).then(e=>{let t=e.user;console.log(t.uid)}).catch(e=>{console.error(e)})},P=async()=>{await (0,u.w7)(p).then(()=>{console.log("Sign-out successful"),b(null),v(null)}).catch(e=>{console.error(e)})};async function C(e){try{let t=(0,l.JU)(f,"users",String(e)),n=await (0,l.QT)(t);if(n.exists())return console.log("Returning user"),e;return await (0,l.pl)(t,{tokens:50},{merge:!0}),console.log("Document written with ID: ",t.id),e}catch(e){return console.error("Error adding document: ",e),null}}async function E(e){try{let t=await (0,l.ET)((0,l.hJ)(f,"requests"),{prompt:n,answer:e.choices[0].message.content,time:(0,l.Bt)(),tokens:"gpt-3.5-turbo"===s?e.usage.total_tokens:2*e.usage.total_tokens,uid:y,model:s});console.log("Document written with ID: ",t.id),O(1)}catch(e){console.error("Error adding document: ",e)}}async function O(e){try{let t=(0,l.JU)(f,"users",String(y)),n=await (0,l.QT)(t);n.exists()?(console.log("Document data:",n.data()),await (0,l.pl)(t,{tokens:0==n.data().tokens?n.data().tokens=0:n.data().tokens=n.data().tokens-e},{merge:!0}),console.log("Document written with ID: ",t.id)):console.log("No such document!")}catch(e){console.error("Error getting document: ",e)}}async function I(){console.log("Calling OpenAI API"),t("Loading...");try{await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer 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"},body:JSON.stringify({model:"gpt-3.5-turbo",messages:[{role:"assistant",content:n}]})}).then(e=>e.json()).then(e=>{console.log(e),t(e.choices[0].message.content),E(e),m(!1)})}catch(e){console.log(e),t("Unfortunately, the API encountered an error. We apologize for the inconvenience, please try again!"),m(!1)}}async function M(){console.log("Calling "+s),t("Loading...");try{await fetch("https://api.openai.com/v1/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer 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"},body:JSON.stringify({model:s,prompt:n,max_tokens:1e3,temperature:.7,top_p:1,frequency_penalty:0,presence_penalty:.3,stop:["\n"]})}).then(e=>e.json()).then(e=>{console.log(e),t(e.choices[0].text)}).then(t=>{i("I have a finetuned model which is supposed to return answers from a textbook it is trained on. It was asked this question: "+n+". The finetuned model gave this answer: "+e+". Use your general knowledge about the topic to make the finetuned model's answer more coherent and accurate, essentially filtering its weird artifacts or unrelated information while preserving its original information the best you can."),I()})}catch(e){console.log(e),t("Unfortunately, the API encountered an error. We apologize for the inconvenience, please try again!"),m(!1)}}let A=e=>{if(e.preventDefault(),m(!0),console.log(w),w>0)"gpt-3.5-turbo"===s?I():M();else{t("Sorry, you have run out of requests!"),m(!1);return}},T=e=>{i(e.target.value)},z=e=>{d(e.target.value)},D=o.createRef();return h?(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:a().container,children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{children:"GPT Textbook"}),(0,r.jsx)("p",{children:"Select your textbook and type your prompt below"}),(0,r.jsxs)("p",{children:[(0,r.jsx)("b",{children:"Requests available:"})," ",w]})]}),(0,r.jsx)("br",{}),(0,r.jsx)("div",{className:a().question,children:(0,r.jsxs)("form",{ref:D,onSubmit:A,children:[(0,r.jsxs)("select",{name:"textbook",id:"textbook",onChange:z,children:[(0,r.jsx)("option",{value:"gpt-3.5-turbo",children:"Base ChatGPT model"}),(0,r.jsx)("option",{value:"curie:ft-personal-2023-05-19-18-07-57",children:"AP European History"})]}),(0,r.jsx)("br",{}),(0,r.jsx)("textarea",{name:"question",id:"question",placeholder:"Question",onChange:T}),(0,r.jsx)("br",{}),(0,r.jsx)("input",{className:a().submit,type:"submit",value:"Ask",disabled:g})]})}),(0,r.jsx)("br",{}),(0,r.jsx)("div",{children:(0,r.jsx)("textarea",{value:e,readOnly:!0,className:a().answer})})]}),(0,r.jsx)("br",{}),(0,r.jsx)(c.ZP,{label:"Sign Out",className:a().SignOut,onClick:P})]})}):(0,r.jsxs)("div",{className:a().container,children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{children:"Welcome to GPTTextbook"}),(0,r.jsx)("p",{children:"The convenience of ChatGPT with the accuracy of a textbook!"})]}),(0,r.jsx)(c.ZP,{className:a().SignIn,onClick:k})]})};t.default=g},2011:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return y}});let r=n(6927),o=n(5909),i=o._(n(6006)),a=r._(n(9619)),s=n(9080),l=n(9600),u=n(5934);n(4169);let c=r._(n(8697)),d={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1};function f(e){return void 0!==e.default}function p(e){return void 0===e?e:"number"==typeof e?Number.isFinite(e)?e:NaN:"string"==typeof e&&/^[0-9]+$/.test(e)?parseInt(e,10):NaN}function g(e,t,n,r,o,i,a){if(!e||e["data-loaded-src"]===t)return;e["data-loaded-src"]=t;let s="decode"in e?e.decode():Promise.resolve();s.catch(()=>{}).then(()=>{if(e.parentElement&&e.isConnected){if("blur"===n&&i(!0),null==r?void 0:r.current){let t=new Event("load");Object.defineProperty(t,"target",{writable:!1,value:e});let n=!1,o=!1;r.current({...t,nativeEvent:t,currentTarget:e,target:e,isDefaultPrevented:()=>n,isPropagationStopped:()=>o,persist:()=>{},preventDefault:()=>{n=!0,t.preventDefault()},stopPropagation:()=>{o=!0,t.stopPropagation()}})}(null==o?void 0:o.current)&&o.current(e)}})}function m(e){let[t,n]=i.version.split("."),r=parseInt(t,10),o=parseInt(n,10);return r>18||18===r&&o>=3?{fetchPriority:e}:{fetchpriority:e}}let h=(0,i.forwardRef)((e,t)=>{let{imgAttributes:n,heightInt:r,widthInt:o,qualityInt:a,className:s,imgStyle:l,blurStyle:u,isLazy:c,fetchPriority:d,fill:f,placeholder:p,loading:h,srcString:b,config:y,unoptimized:v,loader:w,onLoadRef:_,onLoadingCompleteRef:x,setBlurComplete:j,setShowAltText:S,onLoad:k,onError:P,...C}=e;return h=c?"lazy":h,i.default.createElement("img",{...C,...m(d),loading:h,width:o,height:r,decoding:"async","data-nimg":f?"fill":"1",className:s,style:{...l,...u},...n,ref:(0,i.useCallback)(e=>{t&&("function"==typeof t?t(e):"object"==typeof t&&(t.current=e)),e&&(P&&(e.src=e.src),e.complete&&g(e,b,p,_,x,j,v))},[b,p,_,x,j,P,v,t]),onLoad:e=>{let t=e.currentTarget;g(t,b,p,_,x,j,v)},onError:e=>{S(!0),"blur"===p&&j(!0),P&&P(e)}})}),b=(0,i.forwardRef)((e,t)=>{var n;let r,o,{src:g,sizes:b,unoptimized:y=!1,priority:v=!1,loading:w,className:_,quality:x,width:j,height:S,fill:k,style:P,onLoad:C,onLoadingComplete:E,placeholder:O="empty",blurDataURL:I,fetchPriority:M,layout:A,objectFit:T,objectPosition:z,lazyBoundary:D,lazyRoot:N,...R}=e,U=(0,i.useContext)(u.ImageConfigContext),J=(0,i.useMemo)(()=>{let e=d||U||l.imageConfigDefault,t=[...e.deviceSizes,...e.imageSizes].sort((e,t)=>e-t),n=e.deviceSizes.sort((e,t)=>e-t);return{...e,allSizes:t,deviceSizes:n}},[U]),F=R.loader||c.default;delete R.loader;let B="__next_img_default"in F;if(B){if("custom"===J.loader)throw Error('Image with src "'+g+'" is missing "loader" prop.\nRead more: https://nextjs.org/docs/messages/next-image-missing-loader')}else{let e=F;F=t=>{let{config:n,...r}=t;return e(r)}}if(A){"fill"===A&&(k=!0);let e={intrinsic:{maxWidth:"100%",height:"auto"},responsive:{width:"100%",height:"auto"}}[A];e&&(P={...P,...e});let t={responsive:"100vw",fill:"100vw"}[A];t&&!b&&(b=t)}let W="",G=p(j),q=p(S);if("object"==typeof(n=g)&&(f(n)||void 0!==n.src)){let e=f(g)?g.default:g;if(!e.src)throw Error("An object should only be passed to the image component src parameter if it comes from a static image import. It must include src. Received "+JSON.stringify(e));if(!e.height||!e.width)throw Error("An object should only be passed to the image component src parameter if it comes from a static image import. It must include height and width. Received "+JSON.stringify(e));if(r=e.blurWidth,o=e.blurHeight,I=I||e.blurDataURL,W=e.src,!k){if(G||q){if(G&&!q){let t=G/e.width;q=Math.round(e.height*t)}else if(!G&&q){let t=q/e.height;G=Math.round(e.width*t)}}else G=e.width,q=e.height}}let L=!v&&("lazy"===w||void 0===w);(!(g="string"==typeof g?g:W)||g.startsWith("data:")||g.startsWith("blob:"))&&(y=!0,L=!1),J.unoptimized&&(y=!0),B&&g.endsWith(".svg")&&!J.dangerouslyAllowSVG&&(y=!0),v&&(M="high");let[V,Q]=(0,i.useState)(!1),[Z,H]=(0,i.useState)(!1),K=p(x),$=Object.assign(k?{position:"absolute",height:"100%",width:"100%",left:0,top:0,right:0,bottom:0,objectFit:T,objectPosition:z}:{},Z?{}:{color:"transparent"},P),Y="blur"===O&&I&&!V?{backgroundSize:$.objectFit||"cover",backgroundPosition:$.objectPosition||"50% 50%",backgroundRepeat:"no-repeat",backgroundImage:'url("data:image/svg+xml;charset=utf-8,'+(0,s.getImageBlurSvg)({widthInt:G,heightInt:q,blurWidth:r,blurHeight:o,blurDataURL:I,objectFit:$.objectFit})+'")'}:{},X=function(e){let{config:t,src:n,unoptimized:r,width:o,quality:i,sizes:a,loader:s}=e;if(r)return{src:n,srcSet:void 0,sizes:void 0};let{widths:l,kind:u}=function(e,t,n){let{deviceSizes:r,allSizes:o}=e;if(n){let e=/(^|\s)(1?\d?\d)vw/g,t=[];for(let r;r=e.exec(n);r)t.push(parseInt(r[2]));if(t.length){let e=.01*Math.min(...t);return{widths:o.filter(t=>t>=r[0]*e),kind:"w"}}return{widths:o,kind:"w"}}if("number"!=typeof t)return{widths:r,kind:"w"};let i=[...new Set([t,2*t].map(e=>o.find(t=>t>=e)||o[o.length-1]))];return{widths:i,kind:"x"}}(t,o,a),c=l.length-1;return{sizes:a||"w"!==u?a:"100vw",srcSet:l.map((e,r)=>s({config:t,src:n,quality:i,width:e})+" "+("w"===u?e:r+1)+u).join(", "),src:s({config:t,src:n,quality:i,width:l[c]})}}({config:J,src:g,unoptimized:y,width:G,quality:K,sizes:b,loader:F}),ee=g,et=(0,i.useRef)(C);(0,i.useEffect)(()=>{et.current=C},[C]);let en=(0,i.useRef)(E);(0,i.useEffect)(()=>{en.current=E},[E]);let er={isLazy:L,imgAttributes:X,heightInt:q,widthInt:G,qualityInt:K,className:_,imgStyle:$,blurStyle:Y,loading:w,config:J,fetchPriority:M,fill:k,unoptimized:y,placeholder:O,loader:F,srcString:ee,onLoadRef:et,onLoadingCompleteRef:en,setBlurComplete:Q,setShowAltText:H,...R};return i.default.createElement(i.default.Fragment,null,i.default.createElement(h,{...er,ref:t}),v?i.default.createElement(a.default,null,i.default.createElement("link",{key:"__nimg-"+X.src+X.srcSet+X.sizes,rel:"preload",as:"image",href:X.srcSet?void 0:X.src,imageSrcSet:X.srcSet,imageSizes:X.sizes,crossOrigin:R.crossOrigin,referrerPolicy:R.referrerPolicy,...m(M)})):null)}),y=b;("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},4920:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AmpStateContext",{enumerable:!0,get:function(){return i}});let r=n(6927),o=r._(n(6006)),i=o.default.createContext({})},5224:function(e,t){"use strict";function n(e){let{ampFirst:t=!1,hybrid:n=!1,hasQuery:r=!1}=void 0===e?{}:e;return t||n&&r}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isInAmpMode",{enumerable:!0,get:function(){return n}})},9619:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{defaultHead:function(){return c},default:function(){return g}});let r=n(6927),o=n(5909),i=o._(n(6006)),a=r._(n(2776)),s=n(4920),l=n(508),u=n(5224);function c(e){void 0===e&&(e=!1);let t=[i.default.createElement("meta",{charSet:"utf-8"})];return e||t.push(i.default.createElement("meta",{name:"viewport",content:"width=device-width"})),t}function d(e,t){return"string"==typeof t||"number"==typeof t?e:t.type===i.default.Fragment?e.concat(i.default.Children.toArray(t.props.children).reduce((e,t)=>"string"==typeof t||"number"==typeof t?e:e.concat(t),[])):e.concat(t)}n(4169);let f=["name","httpEquiv","charSet","itemProp"];function p(e,t){let{inAmpMode:n}=t;return e.reduce(d,[]).reverse().concat(c(n).reverse()).filter(function(){let e=new Set,t=new Set,n=new Set,r={};return o=>{let i=!0,a=!1;if(o.key&&"number"!=typeof o.key&&o.key.indexOf("$")>0){a=!0;let t=o.key.slice(o.key.indexOf("$")+1);e.has(t)?i=!1:e.add(t)}switch(o.type){case"title":case"base":t.has(o.type)?i=!1:t.add(o.type);break;case"meta":for(let e=0,t=f.length;e<t;e++){let t=f[e];if(o.props.hasOwnProperty(t)){if("charSet"===t)n.has(t)?i=!1:n.add(t);else{let e=o.props[t],n=r[t]||new Set;("name"!==t||!a)&&n.has(e)?i=!1:(n.add(e),r[t]=n)}}}}return i}}()).reverse().map((e,t)=>{let r=e.key||t;if(!n&&"link"===e.type&&e.props.href&&["https://fonts.googleapis.com/css","https://use.typekit.net/"].some(t=>e.props.href.startsWith(t))){let t={...e.props||{}};return t["data-href"]=t.href,t.href=void 0,t["data-optimized-fonts"]=!0,i.default.cloneElement(e,t)}return i.default.cloneElement(e,{key:r})})}let g=function(e){let{children:t}=e,n=(0,i.useContext)(s.AmpStateContext),r=(0,i.useContext)(l.HeadManagerContext);return i.default.createElement(a.default,{reduceComponentsToState:p,headManager:r,inAmpMode:(0,u.isInAmpMode)(n)},t)};("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},9080:function(e,t){"use strict";function n(e){let{widthInt:t,heightInt:n,blurWidth:r,blurHeight:o,blurDataURL:i,objectFit:a}=e,s=r||t,l=o||n,u=i.startsWith("data:image/jpeg")?"%3CfeComponentTransfer%3E%3CfeFuncA type='discrete' tableValues='1 1'/%3E%3C/feComponentTransfer%3E%":"";return s&&l?"%3Csvg xmlns='http%3A//www.w3.org/2000/svg' viewBox='0 0 "+s+" "+l+"'%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='"+(r&&o?"1":"20")+"'/%3E"+u+"%3C/filter%3E%3Cimage preserveAspectRatio='none' filter='url(%23b)' x='0' y='0' height='100%25' width='100%25' href='"+i+"'/%3E%3C/svg%3E":"%3Csvg xmlns='http%3A//www.w3.org/2000/svg'%3E%3Cimage style='filter:blur(20px)' preserveAspectRatio='"+("contain"===a?"xMidYMid":"cover"===a?"xMidYMid slice":"none")+"' x='0' y='0' height='100%25' width='100%25' href='"+i+"'/%3E%3C/svg%3E"}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getImageBlurSvg",{enumerable:!0,get:function(){return n}})},5934:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ImageConfigContext",{enumerable:!0,get:function(){return a}});let r=n(6927),o=r._(n(6006)),i=n(9600),a=o.default.createContext(i.imageConfigDefault)},9600:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{VALID_LOADERS:function(){return n},imageConfigDefault:function(){return r}});let n=["default","imgix","cloudinary","akamai","custom"],r={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",loaderFile:"",domains:[],disableStaticImages:!1,minimumCacheTTL:60,formats:["image/webp"],dangerouslyAllowSVG:!1,contentSecurityPolicy:"script-src 'none'; frame-src 'none'; sandbox;",contentDispositionType:"inline",remotePatterns:[],unoptimized:!1}},8697:function(e,t){"use strict";function n(e){let{config:t,src:n,width:r,quality:o}=e;return t.path+"?url="+encodeURIComponent(n)+"&w="+r+"&q="+(o||75)}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r}}),n.__next_img_default=!0;let r=n},2776:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s}});let r=n(5909),o=r._(n(6006)),i=o.useLayoutEffect,a=o.useEffect;function s(e){let{headManager:t,reduceComponentsToState:n}=e;function r(){if(t&&t.mountedInstances){let r=o.Children.toArray(Array.from(t.mountedInstances).filter(Boolean));t.updateHead(n(r,e))}}return i(()=>{var n;return null==t||null==(n=t.mountedInstances)||n.add(e.children),()=>{var n;null==t||null==(n=t.mountedInstances)||n.delete(e.children)}}),i(()=>(t&&(t._pendingUpdate=r),()=>{t&&(t._pendingUpdate=r)})),a(()=>(t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null),()=>{t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null)})),null}},4169:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"warnOnce",{enumerable:!0,get:function(){return n}});let n=e=>{}},3552:function(e,t,n){"use strict";n.r(t),t.default="db1badf2cc32"},6169:function(e){e.exports={container:"page_container__CxB1d",submit:"page_submit__PFV35",answer:"page_answer__t8_Zs",SignIn:"page_SignIn__6heJD",SignOut:"page_SignOut__wApM0"},e.exports.__checksum="10906c7a1c96"}},function(e){e.O(0,[613,104,559,667,139,744],function(){return e(e.s=6056)}),_N_E=e.O()}]);