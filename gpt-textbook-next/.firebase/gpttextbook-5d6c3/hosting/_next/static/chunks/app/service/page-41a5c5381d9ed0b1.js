(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[121],{6130:function(e,t,n){Promise.resolve().then(n.bind(n,1808))},1808:function(e,t,n){"use strict";n.r(t);var o=n(9268),a=n(6006),s=n(6169),r=n.n(s),i=n(1313),c=n(6936),l=n(4734),u=n(4313);let d=(0,i.ZF)({apiKey:"AIzaSyC8x4gmoJWbQJ3xHc1zydFCMlazRJWMBr0",authDomain:"gpttextbook-5d6c3.firebaseapp.com",projectId:"gpttextbook-5d6c3",storageBucket:"gpttextbook-5d6c3.appspot.com",messagingSenderId:"587182465589",appId:"1:587182465589:web:878023831c861384e9477c",measurementId:"G-370WMEKGLZ"}),h=(0,c.ad)(d),g=(0,l.v0)(),p=()=>{let[e,t]=(0,a.useState)("Answer appears here!"),[n,s]=(0,a.useState)("No answer yet..."),[i,d]=(0,a.useState)("gpt-3.5-turbo"),[p,m]=(0,a.useState)(!1),[x,f]=(0,a.useState)(null),[b,y]=(0,a.useState)(null),[w,k]=(0,a.useState)(0),[j,v]=(0,a.useState)(!1),S=async()=>{try{let e=(0,c.JU)(h,"users",String(b)),t=await (0,c.QT)(e);t.exists()?(console.log("Document data:",t.data()),k(t.data().tokens)):(console.log("No such document!"),k(0))}catch(e){console.error("Error getting document: ",e),k(0)}};(0,a.useEffect)(()=>{S();let e=setInterval(S,5e3);return()=>clearInterval(e)},[b]),(0,a.useEffect)(()=>{let e=(0,l.Aj)(g,e=>{e?(f(e),y(e.uid),console.log(e.uid),I(e.uid)):(f(null),y(null))});return()=>e()},[]);let _=async e=>{e.preventDefault();let t=new l.hJ;await (0,l.rh)(g,t).then(e=>{let t=e.user;console.log(t.uid)}).catch(e=>{console.error(e)})},T=async()=>{await (0,l.w7)(g).then(()=>{console.log("Sign-out successful"),f(null),y(null)}).catch(e=>{console.error(e)})};async function I(e){try{let t=(0,c.JU)(h,"users",String(e)),n=await (0,c.QT)(t);if(n.exists())return console.log("Returning user"),e;return await (0,c.pl)(t,{tokens:50},{merge:!0}),console.log("Document written with ID: ",t.id),e}catch(e){return console.error("Error adding document: ",e),null}}async function P(e){try{let t=await (0,c.ET)((0,c.hJ)(h,"requests"),{prompt:n,answer:e.choices[0].message.content,time:(0,c.Bt)(),tokens:"gpt-3.5-turbo"===i?e.usage.total_tokens:2*e.usage.total_tokens,uid:b,model:i});console.log("Document written with ID: ",t.id),C(1)}catch(e){console.error("Error adding document: ",e)}}async function C(e){try{let t=(0,c.JU)(h,"users",String(b)),n=await (0,c.QT)(t);n.exists()?(console.log("Document data:",n.data()),await (0,c.pl)(t,{tokens:0==n.data().tokens?n.data().tokens=0:n.data().tokens=n.data().tokens-e},{merge:!0}),console.log("Document written with ID: ",t.id)):console.log("No such document!")}catch(e){console.error("Error getting document: ",e)}}async function J(){console.log("Calling OpenAI API"),t("Loading...");try{await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer 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"},body:JSON.stringify({model:"gpt-3.5-turbo",messages:[{role:"assistant",content:n}]})}).then(e=>e.json()).then(e=>{console.log(e),t(e.choices[0].message.content),P(e),m(!1)})}catch(e){console.log(e),t("Unfortunately, the API encountered an error. We apologize for the inconvenience, please try again!"),m(!1)}}async function N(){console.log("Calling "+i),t("Loading...");try{await fetch("https://api.openai.com/v1/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer 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"},body:JSON.stringify({model:i,prompt:n,max_tokens:1e3,temperature:.7,top_p:1,frequency_penalty:0,presence_penalty:.3,stop:["\n"]})}).then(e=>e.json()).then(e=>{console.log(e),t(e.choices[0].text)}).then(t=>{s("I have a finetuned model which is supposed to return answers from a textbook it is trained on. It was asked this question: "+n+". The finetuned model gave this answer: "+e+". Use your general knowledge about the topic to make the finetuned model's answer more coherent and accurate, essentially filtering its weird artifacts or unrelated information while preserving its original information the best you can."),J()})}catch(e){console.log(e),t("Unfortunately, the API encountered an error. We apologize for the inconvenience, please try again!"),m(!1)}}let D=e=>{if(e.preventDefault(),m(!0),console.log(w),w>0)"gpt-3.5-turbo"===i?J():N();else{t("Sorry, you have run out of requests!"),m(!1);return}},E=e=>{s(e.target.value)},O=e=>{d(e.target.value)},A=a.createRef();return x?(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:r().container,children:[(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{children:"GPT Textbook"}),(0,o.jsx)("p",{children:"Select your textbook and type your prompt below"}),(0,o.jsxs)("p",{children:[(0,o.jsx)("b",{children:"Requests available:"})," ",w]})]}),(0,o.jsx)("br",{}),(0,o.jsx)("div",{className:r().question,children:(0,o.jsxs)("form",{ref:A,onSubmit:D,children:[(0,o.jsxs)("select",{name:"textbook",id:"textbook",onChange:O,children:[(0,o.jsx)("option",{value:"gpt-3.5-turbo",children:"Base ChatGPT model"}),(0,o.jsx)("option",{value:"curie:ft-personal-2023-05-19-18-07-57",children:"AP European History"})]}),(0,o.jsx)("br",{}),(0,o.jsx)("textarea",{name:"question",id:"question",placeholder:"Question",onChange:E}),(0,o.jsx)("br",{}),(0,o.jsx)("input",{className:r().submit,type:"submit",value:"Ask",disabled:p})]})}),(0,o.jsx)("br",{}),(0,o.jsx)("div",{children:(0,o.jsx)("textarea",{value:e,readOnly:!0,className:r().answer})})]}),(0,o.jsx)("br",{}),(0,o.jsx)(u.ZP,{label:"Sign Out",className:r().SignOut,onClick:T})]})}):(0,o.jsxs)("div",{className:r().container,children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{children:"Welcome to GPTTextbook"}),(0,o.jsx)("p",{children:"The convenience of ChatGPT with the accuracy of a textbook!"})]}),(0,o.jsx)(u.ZP,{className:r().SignIn,onClick:_})]})};t.default=p},6169:function(e){e.exports={container:"page_container__CxB1d",submit:"page_submit__PFV35",answer:"page_answer__t8_Zs",SignIn:"page_SignIn__6heJD",SignOut:"page_SignOut__wApM0"},e.exports.__checksum="10906c7a1c96"}},function(e){e.O(0,[613,104,559,667,139,744],function(){return e(e.s=6130)}),_N_E=e.O()}]);